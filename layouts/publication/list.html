{{ define "main" }}
<section id="publications" class="pub-list">
  {{ $pages := .Pages }}
  {{ if not (gt (len $pages) 0) }}
    <p>No publications found.</p>
  {{ else }}
    <ul class="pub-ul">
      {{ range $pages.ByDate.Reverse }}
        {{- $p := .Params -}}
        {{- $year := cond (ne (.Date.Format "2006") "0001") (.Date.Format "2006") $p.year -}}
        {{- $authors := "" -}}
        {{- if $p.authors }}{{ $authors = delimit $p.authors ", " }}{{ end -}}

        <li class="pub-item">
          <div class="pub-cite">
            {{ with $authors }}{{ . }}. {{ end }}
            <a class="pub-title" href="{{ .RelPermalink }}">{{ .Title }}</a>.
            {{ with $p.publication }} <em>{{ . }}</em>.{{ end }}
            {{ with $year }} ({{ . }}).{{ end }}
          </div>

          <div class="pub-links">
            <!-- URL (internal page) -->
            <a class="pub-link" href="{{ .RelPermalink }}">
              <svg class="ico" viewBox="0 0 24 24" aria-hidden="true"><path d="M3.9 12a5 5 0 0 1 5-5h3v2h-3a3 3 0 1 0 0 6h3v2h-3a5 5 0 0 1-5-5Zm6.2 1h3.8v-2H10.1v2Zm4-6h3a5 5 0 1 1 0 10h-3v-2h3a3 3 0 1 0 0-6h-3V7Z"/></svg>
              URL
            </a>

            <!-- CITE (anchor on the single page; Wowchemy/Hugo Blox uses #citation) -->
            <a class="pub-link" href="{{ .RelPermalink }}#citation">
              <svg class="ico" viewBox="0 0 24 24" aria-hidden="true"><path d="M7 4h10v2H7V4Zm0 4h7v2H7V8Zm0 4h10v2H7v-2Zm0 4h7v2H7v-2Z"/></svg>
              CITE
            </a>

            <!-- DOI (external) -->
            {{ with $p.doi }}
              <a class="pub-link" href="https://doi.org/{{ . }}" target="_blank" rel="noopener">
                <svg class="ico" viewBox="0 0 24 24" aria-hidden="true"><path d="M14 3h7v7h-2V6.41l-8.29 8.3-1.42-1.42 8.3-8.29H14V3ZM5 5h6v2H7v10h10v-4h2v6H5V5Z"/></svg>
                DOI
              </a>
            {{ end }}
          </div>
        </li>
      {{ end }}
    </ul>
  {{ end }}
</section>
{{ end }}
